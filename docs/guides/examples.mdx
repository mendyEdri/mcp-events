---
title: Examples
description: Real-world patterns and code examples for MCPE.
---

## GitHub Issue Monitor

An agent that watches for new GitHub issues and auto-triages them.

<CodeGroup>
```typescript Server
import { EventsServer } from "@mcpe/core";
import { StdioServerTransport } from "@modelcontextprotocol/sdk/server/stdio.js";
import express from "express";

const server = new EventsServer({
  name: "github-monitor",
  version: "1.0.0",
  events: {
    supportedSources: ["github"],
    deliveryChannels: ["realtime"],
  },
});

// Bridge GitHub webhooks to MCPE events
const app = express();
app.post("/webhook", express.json(), (req, res) => {
  const ghEvent = req.headers["x-github-event"];
  const action = req.body.action;

  server.publish(`github.${ghEvent}.${action}`, req.body, {
    source: "github",
    sourceEventId: req.headers["x-github-delivery"] as string,
    priority: ghEvent === "security_advisory" ? "critical" : "normal",
    tags: [req.body.repository?.full_name].filter(Boolean),
  });

  res.sendStatus(200);
});

app.listen(3001);
await server.connect(new StdioServerTransport());
```

```typescript Client
import { EventsClient } from "@mcpe/core";
import { StdioClientTransport } from "@modelcontextprotocol/sdk/client/stdio.js";

const client = new EventsClient({ name: "triage-agent", version: "1.0.0" });
await client.connect(
  new StdioClientTransport({ command: "node", args: ["./github-monitor.js"] })
);

await client.subscribe({
  filter: {
    sources: ["github"],
    eventTypes: ["github.issues.opened"],
  },
  delivery: { channels: ["realtime"] },
});

client.onEvent("github.issues.opened", async (event) => {
  const { title, body, labels } = event.data;
  console.log(`New issue: ${title}`);

  // Auto-triage logic
  if (title.toLowerCase().includes("bug")) {
    console.log("â†’ Auto-labeled as bug");
  }
});
```
</CodeGroup>

## Daily Digest

Collect events throughout the day and deliver a summary.

```typescript
const client = new EventsClient({ name: "digest-bot", version: "1.0.0" });
await client.connect(transport);

// Server-side cron delivery
await client.subscribe({
  filter: { sources: ["github", "slack"] },
  delivery: {
    channels: ["cron"],
    cronSchedule: {
      expression: "0 17 * * 1-5",   // 5 PM weekdays
      timezone: "America/New_York",
      maxEventsPerDelivery: 200,
    },
  },
});

client.onBatch((events, subId) => {
  const bySource = {};
  for (const event of events) {
    const src = event.metadata.source;
    bySource[src] = (bySource[src] || 0) + 1;
  }

  console.log("=== Daily Digest ===");
  for (const [source, count] of Object.entries(bySource)) {
    console.log(`  ${source}: ${count} events`);
  }
});
```

## Alert Pipeline

Route critical alerts to a webhook and an agent handler.

```typescript
// Webhook for PagerDuty
await client.subscribe({
  filter: {
    eventTypes: ["alert.*"],
    priority: ["critical"],
  },
  delivery: { channels: ["realtime"] },
  handler: {
    type: "webhook",
    url: "https://events.pagerduty.com/v2/enqueue",
    headers: {
      "Content-Type": "application/json",
    },
    timeout: 5000,
  },
});

// Agent for analysis
await client.subscribe({
  filter: {
    eventTypes: ["alert.*"],
    priority: ["high", "critical"],
  },
  delivery: { channels: ["realtime"] },
  handler: {
    type: "agent",
    systemPrompt:
      "Analyze this alert. Determine root cause and suggest remediation steps.",
    tools: ["run_diagnostic", "check_logs", "restart_service"],
  },
});
```

## Multi-Source Event Aggregator

Subscribe to multiple sources and correlate events.

```typescript
const client = new EventsClient({ name: "correlator", version: "1.0.0" });
await client.connect(transport);

// Track recent events for correlation
const recentEvents: MCPEvent[] = [];

await client.subscribe({
  filter: {
    sources: ["github", "slack", "custom"],
    priority: ["high", "critical"],
  },
  delivery: { channels: ["realtime"] },
});

client.onEvent("*", (event) => {
  recentEvents.push(event);

  // Keep last 100 events
  if (recentEvents.length > 100) recentEvents.shift();

  // Correlate: deploy followed by alert within 5 minutes
  if (event.type.startsWith("alert.")) {
    const fiveMinAgo = Date.now() - 5 * 60 * 1000;
    const recentDeploy = recentEvents.find(
      (e) =>
        e.type === "custom.deploy.completed" &&
        new Date(e.metadata.timestamp).getTime() > fiveMinAgo
    );

    if (recentDeploy) {
      console.log("Alert may be related to recent deployment:", recentDeploy.data);
    }
  }
});
```

## Scheduled Reminder

Collect events and deliver them at a specific time.

```typescript
// Collect Slack messages for the next 2 hours, then deliver
const twoHoursFromNow = new Date(Date.now() + 2 * 60 * 60 * 1000);

await client.subscribe({
  filter: { sources: ["slack"], eventTypes: ["slack.message"] },
  delivery: {
    channels: ["scheduled"],
    scheduledDelivery: {
      deliverAt: twoHoursFromNow.toISOString(),
      autoExpire: true,
      description: "2-hour Slack catch-up",
    },
  },
});

client.onBatch((events) => {
  console.log(`Slack catch-up: ${events.length} messages`);
  for (const event of events) {
    console.log(`  [${event.data.channel}] ${event.data.user}: ${event.data.text}`);
  }
});
```

## Client-Side Cron with Local Processing

Use client-side scheduling for local event processing.

```typescript
await client.subscribeWithLocalCron(
  { sources: ["github"], eventTypes: ["github.push"] },
  {
    expression: "*/5 * * * *",  // Every 5 minutes
    timezone: "UTC",
    maxEvents: 500,
  },
  (events) => {
    if (events.length === 0) return;

    // Deduplicate by repo
    const repos = new Set(events.map((e) => e.data.repo));
    console.log(
      `Last 5 min: ${events.length} pushes across ${repos.size} repos`
    );
  }
);
```

## Running the Examples

The repository includes runnable examples:

```bash
# Clone and build
git clone https://github.com/anthropics/mcp-event.git
cd mcp-event
pnpm install && pnpm build

# WebSocket demo
cd examples/webpush-demo
npx tsx server-ws.ts        # Terminal 1
npx tsx cli-receive.ts      # Terminal 2
npx tsx cli-publish.ts github.push '{"repo":"test"}'  # Terminal 3

# SSE demo
cd examples/sse-demo
npx tsx server.ts           # Terminal 1
```
