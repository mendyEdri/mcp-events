---
title: Types
description: Core type definitions for MCPE events, filters, subscriptions, and handlers.
---

All types are exported from `@mcpe/core`.

```typescript
import type {
  MCPEvent,
  EventMetadata,
  EventFilter,
  Subscription,
  DeliveryPreferences,
  EventHandler,
  EventsCapability,
  // ...
} from "@mcpe/core";
```

## Event Types

### MCPEvent

```typescript
interface MCPEvent {
  id: string;                        // Unique event ID (UUID)
  type: string;                      // Hierarchical type (e.g., "github.issue.opened")
  data: Record<string, unknown>;     // Event-specific payload
  metadata: EventMetadata;
}
```

### EventMetadata

```typescript
interface EventMetadata {
  source: EventSource;               // Origin system
  sourceEventId?: string;            // Original event ID from source
  timestamp: string;                 // ISO 8601 datetime
  priority: EventPriority;           // Default: "normal"
  tags?: string[];                   // Optional categorization
}
```

### EventSource

```typescript
type EventSource = "github" | "gmail" | "slack" | "custom";
```

### EventPriority

```typescript
type EventPriority = "low" | "normal" | "high" | "critical";
```

---

## Filter Types

### EventFilter

```typescript
interface EventFilter {
  sources?: EventSource[];           // Filter by source (AND with other filters)
  eventTypes?: string[];             // Filter by type, supports wildcards
  tags?: string[];                   // Filter by tags (OR logic within tags)
  priority?: EventPriority[];        // Filter by priority level
}
```

---

## Subscription Types

### Subscription

```typescript
interface Subscription {
  id: string;                        // UUID
  clientId: string;                  // Owning client ID
  filter: EventFilter;
  delivery: DeliveryPreferences;
  handler?: EventHandler;
  status: SubscriptionStatus;        // Default: "active"
  createdAt: string;                 // ISO 8601
  updatedAt: string;                 // ISO 8601
  expiresAt?: string;                // ISO 8601
}
```

### SubscriptionStatus

```typescript
type SubscriptionStatus = "active" | "paused" | "expired";
```

### CreateSubscriptionRequest

```typescript
interface CreateSubscriptionRequest {
  filter: EventFilter;
  delivery: DeliveryPreferences;
  handler?: EventHandler;
  expiresAt?: string;
}
```

### UpdateSubscriptionRequest

```typescript
interface UpdateSubscriptionRequest {
  filter?: EventFilter;
  delivery?: DeliveryPreferences;
  handler?: EventHandler | null;     // null to remove handler
  status?: SubscriptionStatus;
  expiresAt?: string | null;         // null to remove expiration
}
```

---

## Delivery Types

### DeliveryPreferences

```typescript
interface DeliveryPreferences {
  channels: DeliveryChannel[];
  cronSchedule?: CronSchedule;
  scheduledDelivery?: ScheduledDelivery;
}
```

### DeliveryChannel

```typescript
type DeliveryChannel = "realtime" | "cron" | "scheduled";
```

### CronSchedule

```typescript
interface CronSchedule {
  expression: string;                // Cron expression (e.g., "0 9 * * *")
  timezone: string;                  // IANA timezone (default: "UTC")
  aggregateEvents: boolean;          // Combine into batch (default: true)
  maxEventsPerDelivery: number;      // Max per batch (default: 100)
}
```

### ScheduledDelivery

```typescript
interface ScheduledDelivery {
  deliverAt: string;                 // ISO 8601 delivery time
  timezone: string;                  // IANA timezone (default: "UTC")
  description?: string;              // Human-readable description
  aggregateEvents: boolean;          // Combine into batch (default: true)
  autoExpire: boolean;               // Expire after delivery (default: true)
}
```

---

## Handler Types

### EventHandler

```typescript
type EventHandler = BashEventHandler | AgentEventHandler | WebhookEventHandler;
```

### BashEventHandler

```typescript
interface BashEventHandler {
  type: "bash";
  command: string;
  args?: string[];
  cwd?: string;
  env?: Record<string, string>;
  input: "stdin" | "env" | "args";   // Default: "stdin"
  timeout: number;                   // Default: 30000
}
```

### AgentEventHandler

```typescript
interface AgentEventHandler {
  type: "agent";
  systemPrompt?: string;
  model?: string;
  instructions?: string;
  tools?: string[];
  maxTokens?: number;
}
```

### WebhookEventHandler

```typescript
interface WebhookEventHandler {
  type: "webhook";
  url: string;
  headers?: Record<string, string>;
  timeout: number;                   // Default: 10000
}
```

---

## Capability Types

### EventsCapability

```typescript
interface EventsCapability {
  maxSubscriptions: number;
  supportedSources: EventSource[];
  deliveryChannels: DeliveryChannel[];
  features: EventsFeatures;
}
```

### EventsFeatures

```typescript
interface EventsFeatures {
  pause: boolean;
  wildcards: boolean;
  cronSchedule: boolean;
  scheduledDelivery: boolean;
}
```

### Default Capability

```typescript
const DEFAULT_EVENTS_CAPABILITY: EventsCapability = {
  maxSubscriptions: 100,
  supportedSources: ["github", "gmail", "slack", "custom"],
  deliveryChannels: ["realtime", "cron", "scheduled"],
  features: {
    pause: true,
    wildcards: true,
    cronSchedule: true,
    scheduledDelivery: true,
  },
};
```

---

## Callback Types

```typescript
type EventCallback = (
  event: MCPEvent,
  subscriptionId: string
) => void | Promise<void>;

type BatchEventCallback = (
  events: MCPEvent[],
  subscriptionId: string
) => void | Promise<void>;

type SubscriptionExpiredCallback = (
  subscriptionId: string
) => void | Promise<void>;
```

---

## Utility Functions

### createEvent

Create an event with auto-generated ID and timestamp.

```typescript
function createEvent(
  type: string,
  data: Record<string, unknown>,
  metadata: Omit<EventMetadata, "timestamp"> & { timestamp?: string }
): MCPEvent;
```

### matchesFilter

Check if an event matches a filter.

```typescript
function matchesFilter(event: MCPEvent, filter: EventFilter): boolean;
```
